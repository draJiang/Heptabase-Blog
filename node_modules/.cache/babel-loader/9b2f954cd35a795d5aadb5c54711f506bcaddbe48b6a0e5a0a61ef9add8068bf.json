{"ast":null,"code":"/**\n * @typedef {import('mdast').ListItem} ListItem\n * @typedef {import('mdast').List} List\n * @typedef {import('hast').Properties} Properties\n * @typedef {import('hast').Element} Element\n * @typedef {import('../index.js').Handler} Handler\n * @typedef {import('../index.js').Content} Content\n */\n\nimport { u } from 'unist-builder';\nimport { all } from '../traverse.js';\n\n/**\n * @type {Handler}\n * @param {ListItem} node\n * @param {List} parent\n */\nexport function listItem(h, node, parent) {\n  const result = all(h, node);\n  const loose = parent ? listLoose(parent) : listItemLoose(node);\n  /** @type {Properties} */\n  const props = {};\n  /** @type {Array<Content>} */\n  const wrapped = [];\n  if (typeof node.checked === 'boolean') {\n    /** @type {Element} */\n    let paragraph;\n    if (result[0] && result[0].type === 'element' && result[0].tagName === 'p') {\n      paragraph = result[0];\n    } else {\n      paragraph = h(null, 'p', []);\n      result.unshift(paragraph);\n    }\n    if (paragraph.children.length > 0) {\n      paragraph.children.unshift(u('text', ' '));\n    }\n    paragraph.children.unshift(h(null, 'input', {\n      type: 'checkbox',\n      checked: node.checked,\n      disabled: true\n    }));\n\n    // According to github-markdown-css, this class hides bullet.\n    // See: <https://github.com/sindresorhus/github-markdown-css>.\n    props.className = ['task-list-item'];\n  }\n  let index = -1;\n  while (++index < result.length) {\n    const child = result[index];\n\n    // Add eols before nodes, except if this is a loose, first paragraph.\n    if (loose || index !== 0 || child.type !== 'element' || child.tagName !== 'p') {\n      wrapped.push(u('text', '\\n'));\n    }\n    if (child.type === 'element' && child.tagName === 'p' && !loose) {\n      wrapped.push(...child.children);\n    } else {\n      wrapped.push(child);\n    }\n  }\n  const tail = result[result.length - 1];\n\n  // Add a final eol.\n  if (tail && (loose || !('tagName' in tail) || tail.tagName !== 'p')) {\n    wrapped.push(u('text', '\\n'));\n  }\n  return h(node, 'li', props, wrapped);\n}\n\n/**\n * @param {List} node\n * @return {Boolean}\n */\nfunction listLoose(node) {\n  let loose = node.spread;\n  const children = node.children;\n  let index = -1;\n  while (!loose && ++index < children.length) {\n    loose = listItemLoose(children[index]);\n  }\n  return Boolean(loose);\n}\n\n/**\n * @param {ListItem} node\n * @return {Boolean}\n */\nfunction listItemLoose(node) {\n  const spread = node.spread;\n  return spread === undefined || spread === null ? node.children.length > 1 : spread;\n}","map":{"version":3,"names":["u","all","listItem","h","node","parent","result","loose","listLoose","listItemLoose","props","wrapped","checked","paragraph","type","tagName","unshift","children","length","disabled","className","index","child","push","tail","spread","Boolean","undefined"],"sources":["/Users/jiangzilong/学习/minpg/Heptabase-Blog/node_modules/mdast-util-to-hast/lib/handlers/list-item.js"],"sourcesContent":["/**\n * @typedef {import('mdast').ListItem} ListItem\n * @typedef {import('mdast').List} List\n * @typedef {import('hast').Properties} Properties\n * @typedef {import('hast').Element} Element\n * @typedef {import('../index.js').Handler} Handler\n * @typedef {import('../index.js').Content} Content\n */\n\nimport {u} from 'unist-builder'\nimport {all} from '../traverse.js'\n\n/**\n * @type {Handler}\n * @param {ListItem} node\n * @param {List} parent\n */\nexport function listItem(h, node, parent) {\n  const result = all(h, node)\n  const loose = parent ? listLoose(parent) : listItemLoose(node)\n  /** @type {Properties} */\n  const props = {}\n  /** @type {Array<Content>} */\n  const wrapped = []\n\n  if (typeof node.checked === 'boolean') {\n    /** @type {Element} */\n    let paragraph\n\n    if (\n      result[0] &&\n      result[0].type === 'element' &&\n      result[0].tagName === 'p'\n    ) {\n      paragraph = result[0]\n    } else {\n      paragraph = h(null, 'p', [])\n      result.unshift(paragraph)\n    }\n\n    if (paragraph.children.length > 0) {\n      paragraph.children.unshift(u('text', ' '))\n    }\n\n    paragraph.children.unshift(\n      h(null, 'input', {\n        type: 'checkbox',\n        checked: node.checked,\n        disabled: true\n      })\n    )\n\n    // According to github-markdown-css, this class hides bullet.\n    // See: <https://github.com/sindresorhus/github-markdown-css>.\n    props.className = ['task-list-item']\n  }\n\n  let index = -1\n\n  while (++index < result.length) {\n    const child = result[index]\n\n    // Add eols before nodes, except if this is a loose, first paragraph.\n    if (\n      loose ||\n      index !== 0 ||\n      child.type !== 'element' ||\n      child.tagName !== 'p'\n    ) {\n      wrapped.push(u('text', '\\n'))\n    }\n\n    if (child.type === 'element' && child.tagName === 'p' && !loose) {\n      wrapped.push(...child.children)\n    } else {\n      wrapped.push(child)\n    }\n  }\n\n  const tail = result[result.length - 1]\n\n  // Add a final eol.\n  if (tail && (loose || !('tagName' in tail) || tail.tagName !== 'p')) {\n    wrapped.push(u('text', '\\n'))\n  }\n\n  return h(node, 'li', props, wrapped)\n}\n\n/**\n * @param {List} node\n * @return {Boolean}\n */\nfunction listLoose(node) {\n  let loose = node.spread\n  const children = node.children\n  let index = -1\n\n  while (!loose && ++index < children.length) {\n    loose = listItemLoose(children[index])\n  }\n\n  return Boolean(loose)\n}\n\n/**\n * @param {ListItem} node\n * @return {Boolean}\n */\nfunction listItemLoose(node) {\n  const spread = node.spread\n\n  return spread === undefined || spread === null\n    ? node.children.length > 1\n    : spread\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}