{"ast":null,"code":"/*!\n * etag\n * Copyright(c) 2014-2016 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict';\n\n/**\n * Module exports.\n * @public\n */\nmodule.exports = etag;\n\n/**\n * Module dependencies.\n * @private\n */\n\nvar crypto = require('crypto');\nvar Stats = require('fs').Stats;\n\n/**\n * Module variables.\n * @private\n */\n\nvar toString = Object.prototype.toString;\n\n/**\n * Generate an entity tag.\n *\n * @param {Buffer|string} entity\n * @return {string}\n * @private\n */\n\nfunction entitytag(entity) {\n  if (entity.length === 0) {\n    // fast-path empty\n    return '\"0-2jmj7l5rSw0yVb/vlWAYkK/YBwk\"';\n  }\n\n  // compute hash of entity\n  var hash = crypto.createHash('sha1').update(entity, 'utf8').digest('base64').substring(0, 27);\n\n  // compute length of entity\n  var len = typeof entity === 'string' ? Buffer.byteLength(entity, 'utf8') : entity.length;\n  return '\"' + len.toString(16) + '-' + hash + '\"';\n}\n\n/**\n * Create a simple ETag.\n *\n * @param {string|Buffer|Stats} entity\n * @param {object} [options]\n * @param {boolean} [options.weak]\n * @return {String}\n * @public\n */\n\nfunction etag(entity, options) {\n  if (entity == null) {\n    throw new TypeError('argument entity is required');\n  }\n\n  // support fs.Stats object\n  var isStats = isstats(entity);\n  var weak = options && typeof options.weak === 'boolean' ? options.weak : isStats;\n\n  // validate argument\n  if (!isStats && typeof entity !== 'string' && !Buffer.isBuffer(entity)) {\n    throw new TypeError('argument entity must be string, Buffer, or fs.Stats');\n  }\n\n  // generate entity tag\n  var tag = isStats ? stattag(entity) : entitytag(entity);\n  return weak ? 'W/' + tag : tag;\n}\n\n/**\n * Determine if object is a Stats object.\n *\n * @param {object} obj\n * @return {boolean}\n * @api private\n */\n\nfunction isstats(obj) {\n  // genuine fs.Stats\n  if (typeof Stats === 'function' && obj instanceof Stats) {\n    return true;\n  }\n\n  // quack quack\n  return obj && typeof obj === 'object' && 'ctime' in obj && toString.call(obj.ctime) === '[object Date]' && 'mtime' in obj && toString.call(obj.mtime) === '[object Date]' && 'ino' in obj && typeof obj.ino === 'number' && 'size' in obj && typeof obj.size === 'number';\n}\n\n/**\n * Generate a tag for a stat.\n *\n * @param {object} stat\n * @return {string}\n * @private\n */\n\nfunction stattag(stat) {\n  var mtime = stat.mtime.getTime().toString(16);\n  var size = stat.size.toString(16);\n  return '\"' + size + '-' + mtime + '\"';\n}","map":{"version":3,"names":["module","exports","etag","crypto","require","Stats","toString","Object","prototype","entitytag","entity","length","hash","createHash","update","digest","substring","len","Buffer","byteLength","options","TypeError","isStats","isstats","weak","isBuffer","tag","stattag","obj","call","ctime","mtime","ino","size","stat","getTime"],"sources":["/Users/jiangzilong/学习/minpg/Heptabase-Blog/node_modules/etag/index.js"],"sourcesContent":["/*!\n * etag\n * Copyright(c) 2014-2016 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict'\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = etag\n\n/**\n * Module dependencies.\n * @private\n */\n\nvar crypto = require('crypto')\nvar Stats = require('fs').Stats\n\n/**\n * Module variables.\n * @private\n */\n\nvar toString = Object.prototype.toString\n\n/**\n * Generate an entity tag.\n *\n * @param {Buffer|string} entity\n * @return {string}\n * @private\n */\n\nfunction entitytag (entity) {\n  if (entity.length === 0) {\n    // fast-path empty\n    return '\"0-2jmj7l5rSw0yVb/vlWAYkK/YBwk\"'\n  }\n\n  // compute hash of entity\n  var hash = crypto\n    .createHash('sha1')\n    .update(entity, 'utf8')\n    .digest('base64')\n    .substring(0, 27)\n\n  // compute length of entity\n  var len = typeof entity === 'string'\n    ? Buffer.byteLength(entity, 'utf8')\n    : entity.length\n\n  return '\"' + len.toString(16) + '-' + hash + '\"'\n}\n\n/**\n * Create a simple ETag.\n *\n * @param {string|Buffer|Stats} entity\n * @param {object} [options]\n * @param {boolean} [options.weak]\n * @return {String}\n * @public\n */\n\nfunction etag (entity, options) {\n  if (entity == null) {\n    throw new TypeError('argument entity is required')\n  }\n\n  // support fs.Stats object\n  var isStats = isstats(entity)\n  var weak = options && typeof options.weak === 'boolean'\n    ? options.weak\n    : isStats\n\n  // validate argument\n  if (!isStats && typeof entity !== 'string' && !Buffer.isBuffer(entity)) {\n    throw new TypeError('argument entity must be string, Buffer, or fs.Stats')\n  }\n\n  // generate entity tag\n  var tag = isStats\n    ? stattag(entity)\n    : entitytag(entity)\n\n  return weak\n    ? 'W/' + tag\n    : tag\n}\n\n/**\n * Determine if object is a Stats object.\n *\n * @param {object} obj\n * @return {boolean}\n * @api private\n */\n\nfunction isstats (obj) {\n  // genuine fs.Stats\n  if (typeof Stats === 'function' && obj instanceof Stats) {\n    return true\n  }\n\n  // quack quack\n  return obj && typeof obj === 'object' &&\n    'ctime' in obj && toString.call(obj.ctime) === '[object Date]' &&\n    'mtime' in obj && toString.call(obj.mtime) === '[object Date]' &&\n    'ino' in obj && typeof obj.ino === 'number' &&\n    'size' in obj && typeof obj.size === 'number'\n}\n\n/**\n * Generate a tag for a stat.\n *\n * @param {object} stat\n * @return {string}\n * @private\n */\n\nfunction stattag (stat) {\n  var mtime = stat.mtime.getTime().toString(16)\n  var size = stat.size.toString(16)\n\n  return '\"' + size + '-' + mtime + '\"'\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}