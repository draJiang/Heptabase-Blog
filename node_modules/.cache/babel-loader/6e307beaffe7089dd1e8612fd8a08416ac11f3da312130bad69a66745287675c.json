{"ast":null,"code":"/**\n * @typedef {import('mdast').FootnoteReference} FootnoteReference\n * @typedef {import('../index.js').Handler} Handler\n */\n\nimport { normalizeUri } from 'micromark-util-sanitize-uri';\nimport { u } from 'unist-builder';\n\n/**\n * @type {Handler}\n * @param {FootnoteReference} node\n */\nexport function footnoteReference(h, node) {\n  const id = String(node.identifier);\n  const safeId = normalizeUri(id.toLowerCase());\n  const index = h.footnoteOrder.indexOf(id);\n  /** @type {number} */\n  let counter;\n  if (index === -1) {\n    h.footnoteOrder.push(id);\n    h.footnoteCounts[id] = 1;\n    counter = h.footnoteOrder.length;\n  } else {\n    h.footnoteCounts[id]++;\n    counter = index + 1;\n  }\n  const reuseCounter = h.footnoteCounts[id];\n  return h(node, 'sup', [h(node.position, 'a', {\n    href: '#' + h.clobberPrefix + 'fn-' + safeId,\n    id: h.clobberPrefix + 'fnref-' + safeId + (reuseCounter > 1 ? '-' + reuseCounter : ''),\n    dataFootnoteRef: true,\n    ariaDescribedBy: 'footnote-label'\n  }, [u('text', String(counter))])]);\n}","map":{"version":3,"names":["normalizeUri","u","footnoteReference","h","node","id","String","identifier","safeId","toLowerCase","index","footnoteOrder","indexOf","counter","push","footnoteCounts","length","reuseCounter","position","href","clobberPrefix","dataFootnoteRef","ariaDescribedBy"],"sources":["/Users/jiangzilong/学习/minpg/Heptabase-Blog/node_modules/mdast-util-to-hast/lib/handlers/footnote-reference.js"],"sourcesContent":["/**\n * @typedef {import('mdast').FootnoteReference} FootnoteReference\n * @typedef {import('../index.js').Handler} Handler\n */\n\nimport {normalizeUri} from 'micromark-util-sanitize-uri'\nimport {u} from 'unist-builder'\n\n/**\n * @type {Handler}\n * @param {FootnoteReference} node\n */\nexport function footnoteReference(h, node) {\n  const id = String(node.identifier)\n  const safeId = normalizeUri(id.toLowerCase())\n  const index = h.footnoteOrder.indexOf(id)\n  /** @type {number} */\n  let counter\n\n  if (index === -1) {\n    h.footnoteOrder.push(id)\n    h.footnoteCounts[id] = 1\n    counter = h.footnoteOrder.length\n  } else {\n    h.footnoteCounts[id]++\n    counter = index + 1\n  }\n\n  const reuseCounter = h.footnoteCounts[id]\n\n  return h(node, 'sup', [\n    h(\n      node.position,\n      'a',\n      {\n        href: '#' + h.clobberPrefix + 'fn-' + safeId,\n        id:\n          h.clobberPrefix +\n          'fnref-' +\n          safeId +\n          (reuseCounter > 1 ? '-' + reuseCounter : ''),\n        dataFootnoteRef: true,\n        ariaDescribedBy: 'footnote-label'\n      },\n      [u('text', String(counter))]\n    )\n  ])\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;;AAEA,SAAQA,YAAY,QAAO,6BAA6B;AACxD,SAAQC,CAAC,QAAO,eAAe;;AAE/B;AACA;AACA;AACA;AACA,OAAO,SAASC,iBAAiB,CAACC,CAAC,EAAEC,IAAI,EAAE;EACzC,MAAMC,EAAE,GAAGC,MAAM,CAACF,IAAI,CAACG,UAAU,CAAC;EAClC,MAAMC,MAAM,GAAGR,YAAY,CAACK,EAAE,CAACI,WAAW,EAAE,CAAC;EAC7C,MAAMC,KAAK,GAAGP,CAAC,CAACQ,aAAa,CAACC,OAAO,CAACP,EAAE,CAAC;EACzC;EACA,IAAIQ,OAAO;EAEX,IAAIH,KAAK,KAAK,CAAC,CAAC,EAAE;IAChBP,CAAC,CAACQ,aAAa,CAACG,IAAI,CAACT,EAAE,CAAC;IACxBF,CAAC,CAACY,cAAc,CAACV,EAAE,CAAC,GAAG,CAAC;IACxBQ,OAAO,GAAGV,CAAC,CAACQ,aAAa,CAACK,MAAM;EAClC,CAAC,MAAM;IACLb,CAAC,CAACY,cAAc,CAACV,EAAE,CAAC,EAAE;IACtBQ,OAAO,GAAGH,KAAK,GAAG,CAAC;EACrB;EAEA,MAAMO,YAAY,GAAGd,CAAC,CAACY,cAAc,CAACV,EAAE,CAAC;EAEzC,OAAOF,CAAC,CAACC,IAAI,EAAE,KAAK,EAAE,CACpBD,CAAC,CACCC,IAAI,CAACc,QAAQ,EACb,GAAG,EACH;IACEC,IAAI,EAAE,GAAG,GAAGhB,CAAC,CAACiB,aAAa,GAAG,KAAK,GAAGZ,MAAM;IAC5CH,EAAE,EACAF,CAAC,CAACiB,aAAa,GACf,QAAQ,GACRZ,MAAM,IACLS,YAAY,GAAG,CAAC,GAAG,GAAG,GAAGA,YAAY,GAAG,EAAE,CAAC;IAC9CI,eAAe,EAAE,IAAI;IACrBC,eAAe,EAAE;EACnB,CAAC,EACD,CAACrB,CAAC,CAAC,MAAM,EAAEK,MAAM,CAACO,OAAO,CAAC,CAAC,CAAC,CAC7B,CACF,CAAC;AACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}