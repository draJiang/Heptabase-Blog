{"ast":null,"code":"/**\n * @typedef {import('mdast').FootnoteReference} FootnoteReference\n * @typedef {import('mdast').FootnoteDefinition} FootnoteDefinition\n * @typedef {import('mdast-util-from-markdown').Extension} FromMarkdownExtension\n * @typedef {import('mdast-util-from-markdown').Handle} FromMarkdownHandle\n * @typedef {import('mdast-util-to-markdown').Options} ToMarkdownExtension\n * @typedef {import('mdast-util-to-markdown').Handle} ToMarkdownHandle\n * @typedef {import('mdast-util-to-markdown').Map} Map\n */\n\nimport { normalizeIdentifier } from 'micromark-util-normalize-identifier';\nimport { association } from 'mdast-util-to-markdown/lib/util/association.js';\nimport { containerFlow } from 'mdast-util-to-markdown/lib/util/container-flow.js';\nimport { indentLines } from 'mdast-util-to-markdown/lib/util/indent-lines.js';\nimport { safe } from 'mdast-util-to-markdown/lib/util/safe.js';\nimport { track } from 'mdast-util-to-markdown/lib/util/track.js';\n\n/**\n * @returns {FromMarkdownExtension}\n */\nexport function gfmFootnoteFromMarkdown() {\n  return {\n    enter: {\n      gfmFootnoteDefinition: enterFootnoteDefinition,\n      gfmFootnoteDefinitionLabelString: enterFootnoteDefinitionLabelString,\n      gfmFootnoteCall: enterFootnoteCall,\n      gfmFootnoteCallString: enterFootnoteCallString\n    },\n    exit: {\n      gfmFootnoteDefinition: exitFootnoteDefinition,\n      gfmFootnoteDefinitionLabelString: exitFootnoteDefinitionLabelString,\n      gfmFootnoteCall: exitFootnoteCall,\n      gfmFootnoteCallString: exitFootnoteCallString\n    }\n  };\n\n  /** @type {FromMarkdownHandle} */\n  function enterFootnoteDefinition(token) {\n    this.enter({\n      type: 'footnoteDefinition',\n      identifier: '',\n      label: '',\n      children: []\n    }, token);\n  }\n\n  /** @type {FromMarkdownHandle} */\n  function enterFootnoteDefinitionLabelString() {\n    this.buffer();\n  }\n\n  /** @type {FromMarkdownHandle} */\n  function exitFootnoteDefinitionLabelString(token) {\n    const label = this.resume();\n    const node = /** @type {FootnoteDefinition} */\n    this.stack[this.stack.length - 1];\n    node.label = label;\n    node.identifier = normalizeIdentifier(this.sliceSerialize(token)).toLowerCase();\n  }\n\n  /** @type {FromMarkdownHandle} */\n  function exitFootnoteDefinition(token) {\n    this.exit(token);\n  }\n\n  /** @type {FromMarkdownHandle} */\n  function enterFootnoteCall(token) {\n    this.enter({\n      type: 'footnoteReference',\n      identifier: '',\n      label: ''\n    }, token);\n  }\n\n  /** @type {FromMarkdownHandle} */\n  function enterFootnoteCallString() {\n    this.buffer();\n  }\n\n  /** @type {FromMarkdownHandle} */\n  function exitFootnoteCallString(token) {\n    const label = this.resume();\n    const node = /** @type {FootnoteDefinition} */\n    this.stack[this.stack.length - 1];\n    node.label = label;\n    node.identifier = normalizeIdentifier(this.sliceSerialize(token)).toLowerCase();\n  }\n\n  /** @type {FromMarkdownHandle} */\n  function exitFootnoteCall(token) {\n    this.exit(token);\n  }\n}\n\n/**\n * @returns {ToMarkdownExtension}\n */\nexport function gfmFootnoteToMarkdown() {\n  footnoteReference.peek = footnoteReferencePeek;\n  return {\n    // This is on by default already.\n    unsafe: [{\n      character: '[',\n      inConstruct: ['phrasing', 'label', 'reference']\n    }],\n    handlers: {\n      footnoteDefinition,\n      footnoteReference\n    }\n  };\n\n  /**\n   * @type {ToMarkdownHandle}\n   * @param {FootnoteReference} node\n   */\n  function footnoteReference(node, _, context, safeOptions) {\n    const tracker = track(safeOptions);\n    let value = tracker.move('[^');\n    const exit = context.enter('footnoteReference');\n    const subexit = context.enter('reference');\n    value += tracker.move(safe(context, association(node), {\n      ...tracker.current(),\n      before: value,\n      after: ']'\n    }));\n    subexit();\n    exit();\n    value += tracker.move(']');\n    return value;\n  }\n\n  /** @type {ToMarkdownHandle} */\n  function footnoteReferencePeek() {\n    return '[';\n  }\n\n  /**\n   * @type {ToMarkdownHandle}\n   * @param {FootnoteDefinition} node\n   */\n  function footnoteDefinition(node, _, context, safeOptions) {\n    const tracker = track(safeOptions);\n    let value = tracker.move('[^');\n    const exit = context.enter('footnoteDefinition');\n    const subexit = context.enter('label');\n    value += tracker.move(safe(context, association(node), {\n      ...tracker.current(),\n      before: value,\n      after: ']'\n    }));\n    subexit();\n    value += tracker.move(']:' + (node.children && node.children.length > 0 ? ' ' : ''));\n    tracker.shift(4);\n    value += tracker.move(indentLines(containerFlow(node, context, tracker.current()), map));\n    exit();\n    return value;\n\n    /** @type {Map} */\n    function map(line, index, blank) {\n      if (index) {\n        return (blank ? '' : '    ') + line;\n      }\n      return line;\n    }\n  }\n}","map":{"version":3,"names":["normalizeIdentifier","association","containerFlow","indentLines","safe","track","gfmFootnoteFromMarkdown","enter","gfmFootnoteDefinition","enterFootnoteDefinition","gfmFootnoteDefinitionLabelString","enterFootnoteDefinitionLabelString","gfmFootnoteCall","enterFootnoteCall","gfmFootnoteCallString","enterFootnoteCallString","exit","exitFootnoteDefinition","exitFootnoteDefinitionLabelString","exitFootnoteCall","exitFootnoteCallString","token","type","identifier","label","children","buffer","resume","node","stack","length","sliceSerialize","toLowerCase","gfmFootnoteToMarkdown","footnoteReference","peek","footnoteReferencePeek","unsafe","character","inConstruct","handlers","footnoteDefinition","_","context","safeOptions","tracker","value","move","subexit","current","before","after","shift","map","line","index","blank"],"sources":["/Users/jiangzilong/学习/minpg/Heptabase-Blog/node_modules/mdast-util-gfm-footnote/index.js"],"sourcesContent":["/**\n * @typedef {import('mdast').FootnoteReference} FootnoteReference\n * @typedef {import('mdast').FootnoteDefinition} FootnoteDefinition\n * @typedef {import('mdast-util-from-markdown').Extension} FromMarkdownExtension\n * @typedef {import('mdast-util-from-markdown').Handle} FromMarkdownHandle\n * @typedef {import('mdast-util-to-markdown').Options} ToMarkdownExtension\n * @typedef {import('mdast-util-to-markdown').Handle} ToMarkdownHandle\n * @typedef {import('mdast-util-to-markdown').Map} Map\n */\n\nimport {normalizeIdentifier} from 'micromark-util-normalize-identifier'\nimport {association} from 'mdast-util-to-markdown/lib/util/association.js'\nimport {containerFlow} from 'mdast-util-to-markdown/lib/util/container-flow.js'\nimport {indentLines} from 'mdast-util-to-markdown/lib/util/indent-lines.js'\nimport {safe} from 'mdast-util-to-markdown/lib/util/safe.js'\nimport {track} from 'mdast-util-to-markdown/lib/util/track.js'\n\n/**\n * @returns {FromMarkdownExtension}\n */\nexport function gfmFootnoteFromMarkdown() {\n  return {\n    enter: {\n      gfmFootnoteDefinition: enterFootnoteDefinition,\n      gfmFootnoteDefinitionLabelString: enterFootnoteDefinitionLabelString,\n      gfmFootnoteCall: enterFootnoteCall,\n      gfmFootnoteCallString: enterFootnoteCallString\n    },\n    exit: {\n      gfmFootnoteDefinition: exitFootnoteDefinition,\n      gfmFootnoteDefinitionLabelString: exitFootnoteDefinitionLabelString,\n      gfmFootnoteCall: exitFootnoteCall,\n      gfmFootnoteCallString: exitFootnoteCallString\n    }\n  }\n\n  /** @type {FromMarkdownHandle} */\n  function enterFootnoteDefinition(token) {\n    this.enter(\n      {type: 'footnoteDefinition', identifier: '', label: '', children: []},\n      token\n    )\n  }\n\n  /** @type {FromMarkdownHandle} */\n  function enterFootnoteDefinitionLabelString() {\n    this.buffer()\n  }\n\n  /** @type {FromMarkdownHandle} */\n  function exitFootnoteDefinitionLabelString(token) {\n    const label = this.resume()\n    const node = /** @type {FootnoteDefinition} */ (\n      this.stack[this.stack.length - 1]\n    )\n    node.label = label\n    node.identifier = normalizeIdentifier(\n      this.sliceSerialize(token)\n    ).toLowerCase()\n  }\n\n  /** @type {FromMarkdownHandle} */\n  function exitFootnoteDefinition(token) {\n    this.exit(token)\n  }\n\n  /** @type {FromMarkdownHandle} */\n  function enterFootnoteCall(token) {\n    this.enter({type: 'footnoteReference', identifier: '', label: ''}, token)\n  }\n\n  /** @type {FromMarkdownHandle} */\n  function enterFootnoteCallString() {\n    this.buffer()\n  }\n\n  /** @type {FromMarkdownHandle} */\n  function exitFootnoteCallString(token) {\n    const label = this.resume()\n    const node = /** @type {FootnoteDefinition} */ (\n      this.stack[this.stack.length - 1]\n    )\n    node.label = label\n    node.identifier = normalizeIdentifier(\n      this.sliceSerialize(token)\n    ).toLowerCase()\n  }\n\n  /** @type {FromMarkdownHandle} */\n  function exitFootnoteCall(token) {\n    this.exit(token)\n  }\n}\n\n/**\n * @returns {ToMarkdownExtension}\n */\nexport function gfmFootnoteToMarkdown() {\n  footnoteReference.peek = footnoteReferencePeek\n\n  return {\n    // This is on by default already.\n    unsafe: [{character: '[', inConstruct: ['phrasing', 'label', 'reference']}],\n    handlers: {footnoteDefinition, footnoteReference}\n  }\n\n  /**\n   * @type {ToMarkdownHandle}\n   * @param {FootnoteReference} node\n   */\n  function footnoteReference(node, _, context, safeOptions) {\n    const tracker = track(safeOptions)\n    let value = tracker.move('[^')\n    const exit = context.enter('footnoteReference')\n    const subexit = context.enter('reference')\n    value += tracker.move(\n      safe(context, association(node), {\n        ...tracker.current(),\n        before: value,\n        after: ']'\n      })\n    )\n    subexit()\n    exit()\n    value += tracker.move(']')\n    return value\n  }\n\n  /** @type {ToMarkdownHandle} */\n  function footnoteReferencePeek() {\n    return '['\n  }\n\n  /**\n   * @type {ToMarkdownHandle}\n   * @param {FootnoteDefinition} node\n   */\n  function footnoteDefinition(node, _, context, safeOptions) {\n    const tracker = track(safeOptions)\n    let value = tracker.move('[^')\n    const exit = context.enter('footnoteDefinition')\n    const subexit = context.enter('label')\n    value += tracker.move(\n      safe(context, association(node), {\n        ...tracker.current(),\n        before: value,\n        after: ']'\n      })\n    )\n    subexit()\n    value += tracker.move(\n      ']:' + (node.children && node.children.length > 0 ? ' ' : '')\n    )\n    tracker.shift(4)\n    value += tracker.move(\n      indentLines(containerFlow(node, context, tracker.current()), map)\n    )\n    exit()\n\n    return value\n\n    /** @type {Map} */\n    function map(line, index, blank) {\n      if (index) {\n        return (blank ? '' : '    ') + line\n      }\n\n      return line\n    }\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}